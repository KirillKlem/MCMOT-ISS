# MCMOT: Многокамерный Многоперсональный Трекер Объектов

[Эксперимент на 1 камере](https://drive.google.com/drive/folders/1HEW4QMCBh-hO_yZ-gFm9FxI3i1Pnt3En?usp=sharing) 
[Эксперимент на 2 камерах](https://drive.google.com/drive/folders/1Bu0eiNzoGKboak8udsyDJYeNiZ-MsCEw?usp=sharing)
[Эксперимент на 5 камерах](https://drive.google.com/drive/folders/1CY83bJwhCwnkGEUvU5oaH_1FZ8hpmIqf?usp=sharing)
[DataDump с источниками, на которые мы опирались](https://docs.google.com/document/d/1pzy4N5eHGiqp4lH3r4ggsgNnijfuKgvlNlmZQEfMseI/edit?tab=t.0)

## Модели reID:
[Путь на драйв](https://drive.google.com/drive/folders/1HhoybORgO1O5dPV7AlhdCZKXMWB9ukTj?usp=sharing) (загрузить в assets папку, по-другому не получилось быстро, а врмея подживает, сорри((( )

## О проекте

Добро пожаловать в **MCMOT** — передовой многокамерный трекер объектов, разработанный для надежного и точного отслеживания нескольких людей одновременно в различных камерах. Используя передовые модели детекции и извлечения признаков, MCMOT обеспечивает согласованность идентификаторов между камерами, что делает его идеальным решением для систем безопасности, мониторинга и анализа поведения.

## Ключевые особенности

- **Многокамерный трекинг:** Поддержка отслеживания объектов в нескольких камерах одновременно с сохранением уникальных идентификаторов.
- **Выбор модели:** Гибкость в выборе модели детекции из доступных вариантов (можно добавить любой размер и версию для YOLO):
  - `yolo11m_trained.pt` — средняя точность и скорость.
  - `yolo11n_trained.pt` — быстрая детекция с немного меньшей точностью.
  - `yolo11s_trained.pt` — оптимизированная для быстродействия модель.
- **Передовая детекция объектов:** Fine-tuning модели YOLOv11 для точной и быстрой детекции людей в кадрах.
- **ReID модель:** Использование продвинутого и уникального Metric Learning'а для надежного распознавания и сопоставления объектов между кадрами и камерами.
- **Управление галереей эмбеддингов:** Эффективное управление эмбеддингами для улучшенного глобального мэтчинга.
- **Визуализация и логирование:** Автоматическое наложение аннотаций на кадры и запись логов для дальнейшего анализа.

## Преимущества проекта

- **Высокая точность:** Современные модели детекции и ReID обеспечивают хорошее качество обнаружение и распознавание объектов.
- **Масштабируемость:** Легко масштабируется для работы с большим количеством камер без существенного снижения производительности.
- **Надежность:** Алгоритм Венгерского метода гарантирует оптимальное сопоставление, минимизируя ошибки трекинга.
- **Гибкость:** Возможность выбора различных моделей YOLO позволяет адаптировать систему под конкретные задачи и ограничения.
- **Простота использования:** Четко структурированный код и подробная документация облегчают развертывание и интеграцию в существующие системы.
- **Адаптивность:** Система автоматически адаптируется к изменениям в окружении и условиям съемки, обеспечивая стабильную работу.

## Достижения

В ходе разработки проекта MCMOT были достигнуты следующие успехи:

- **Разработка эффективной системы трекинга:** Создана система, способная надежно отслеживать несколько людей одновременно в различных камерах с минимальными ошибками.
- **Управление галереей эмбеддингов:** Разработана система управления эмбеддингами, обеспечивающая стабильность идентификаторов и предотвращающая частые изменения.
- **Интеграция передовых моделей:** Успешно интегрированы модели YOLOv8 и ReID для обеспечения высокой точности детекции и распознавания.
- **Создание удобных инструментов визуализации и логирования:** Разработаны механизмы для визуального отображения результатов трекинга и записи логов для анализа.


## Проблемы и Обоснования

В процессе разработки возникли некоторые сложности, связанные с настройкой порогов схожести в алгоритмах мэтчинга. Несмотря на тщательный подбор параметров, не всегда удавалось достичь оптимального баланса между точностью и скоростью трекинга. Основные причины:

- **Ограничения вычислительной мощности:** Точный подбор порогов требует значительных вычислительных ресурсов, что не всегда возможно при ограниченной инфраструктуре.
- **Разнообразие условий съемки:** Различные условия освещения, углы обзора и расстояния между камерами усложняют универсальную настройку порогов.
- **Вариативность эмбеддингов:** Эмбеддинги могут варьироваться в зависимости от позы, одежды и других факторов, что влияет на стабильность мэтчинга.

Для преодоления этих проблем планируется внедрение адаптивных методов настройки порогов и использование дополнительных метрик для повышения надежности трекинга.

## Будущие Улучшения

- **Адаптивная настройка порогов:** Разработка методов динамической настройки порогов схожести на основе текущих условий съемки.
- **Интеграция пространственных ограничений:** Использование информации о геометрии расположения камер для улучшения глобального мэтчинга.
- **Расширение функционала:** Поддержка большего количества камер и улучшение масштабируемости системы.
- **Улучшение управления треками:** Внедрение механизмов для управления историей движения и повышения устойчивости трекинга.
- **Оптимизация производительности:** Улучшение использования ресурсов для повышения скорости обработки без потери точности.

